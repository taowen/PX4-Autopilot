 这份代码主要实现了直接任务着陆（RtlDirectMissionLand）的功能，它对飞行器的任务状态数据进行了以下业务操作：

1. **更新和管理任务数据缓存**：代码通过更新dataman缓存来确保任务数据是最新的，并且管理缓存的大小，以适应任务的起始索引和结束索引之间的数据量。

2. **处理任务激活和非激活状态**：在任务激活时，代码检查是否需要爬升到指定的返航高度，并根据飞行器的状态（如是否为垂直起降VTOL）设置相应的任务项。在任务非激活时，更新数据缓存。

3. **计算返航时间估计**：代码通过遍历任务中的每个航点，根据航点的类型（如盘旋、着陆等）和飞行器当前的位置，计算从当前位置到每个航点的水平和垂直距离，以及可能的等待时间，从而估计整个返航任务所需的时间。
